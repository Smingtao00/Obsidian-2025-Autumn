#图论

1. [[并查集]]
2. [[森林与二叉树的等价转换]]
3. [[顺序存储]]
4. [[最近公共祖先（LCA）]]
5. [[树链剖分]]
6. [[最小生成树]]
7. [[树状数组]]
8. [[二叉搜索树（BST）]]

### 无向树及其性质

连通无回路的无向简单图称作==无向树== ，或简称为==树== ．每个连通分支都是树的无向图称作==森林==．平凡图称作==平凡树== ．在无向树中，悬挂顶点称作==树叶== ，度数大于等于 2 的顶点称作==分支点== .

### 定理 7.1.1

设 $G = <V,E>$ 是 $n$ 阶 $m$ 条边的无向简单图，则下列各命题是等价的：

1. $G$ 是树.
2. $G$ 中任意两个顶点之间存在唯一的路径.（**唯一路径**）
3. $G$ 中无回路且 $m = n - 1$.
4. $G$ 是连通的且 $m = n - 1$.
5. $G$ 是联通的且任何边均为桥. （**极小连通**）
6. $G$ 中没有回路，但在任何两个不同的顶点之间加一条新边后所得的图中有唯一的一个含新边的圈.（**极大无回**）

### 定理 7.1.2

设 $T$ 是 $n$ 阶非平凡的无向树，则 $T$ 中至少有两片树叶.

> 常称只有一个分支点，且分支点的度数为 n − 1 的 n(⩾ 3) 阶无向树为==星形图==， 称其唯一的分支点为==星心==.

### 定理 7.1.3
当 $\delta(G) \geq k$ 时，$G$ 必包含与任意 $k + 1$ 阶树同构的子图。



## 生成树

### 定理 9.13
$T$ 是连通图 $G$ 的生成树，$S$ 是 $G$ 中的割集 $\Rightarrow E(T) \cap S \neq \emptyset$

> 每一个割集必定含有生成树中的边，否则去除割集中的边后还是连通图，矛盾


### 定理 9.4
设 $G$ 是连通图，$T$ 是 $G$ 的生成树，$e$ 是 $T$ 的弦。则 $T \cup e$ 中存在由弦 $e$ 和其他树枝组成的圈。
并且不同的弦对应不同的圈。

> 显然

### 基本回路
设 $G$ 是 $n$ 阶 $m$ 条边的无向连通图，$T$ 是 $G$ 的生成树 $$\overline{T} = \{e_1^{'},e_2^{'},\dots,e_{m-n+1}^{'}\}$$
- **基本回路**：$T \cup e^{'}_r$ 中的唯一回路 $C_r$
- **基本回路系统**：$\{C_1, C_2, \dots, C_{m - n + 1}\}$
- **圈秩** $\xi(G)$：$\xi(G) = m - n + 1$


### 破圈法
习题：设 $G$ 是无向连通图，$G^{'} \subseteq G$，$G^{'}$ 无圈，则 $G$ 中存在生成树 $T$，$G^{'} \subseteq T \subseteq G$

如何构造包含 $G^{'}$ 的生成树？

设 $G$ 有圈 $C_1$ (否则 $G$ 是树，$T = G$)
则 $\exists e_1 \in E(C_1) - E(G^{'})$
令 $G_1 = G - \{e_1\}$
若 $G_2$ 还有圈 $C_2 \dots \dots$

重复进行，直到 $G_k = G - \{e_1, e_2, \dots, e_k\}$ 无圈。

$T = G_k$


### 定理 9.5 树枝与割集的关系
设 $G$ 是连通图，$T$ 是 $G$ 的生成树，$e$ 是 $T$ 的树枝。则 $G$ 中存在由树枝 $e$ 和其他弦组成的割集，并且不同的树枝对应不同的割集。


### 基本割集
设 $G$ 是 $n$ 阶 $m$ 边无向连通图，$T$ 是 $G$ 的生成树 $$T = \{e_1, e_2, \dots, e_{n - 1}\}$$
- 基本割集：$e_r$ 对应的唯一割集 $S_r$
- 基本割集系统：$\{S_1, S_2, \dots, S_{n - 1}\}$
- 割集秩 $\eta(G)$：$\eta(G) = n - 1$


## 生成树的计数

$\tau(G)$：标定图 $G$ 的生成树的个数
- $T_1 \neq T_2$：$E(T_1) \neq E(T_2)$
- $G - e$：删除（deletion）
- $G / e$：收缩（contraction）

### 定理 9.6 生成树计数递推公式

$\forall e$ 非环，$\tau(G) = \tau(G - e) + \tau(G / e)$

1. 不含 $e$ 的 $G$ 的生成树个数 $\tau(G - e)$
2. 含 $e$ 的 $G$ 的生成树个数 $\tau(G / e)$



### 树的Prufer编码
输入：$n$ 个顶点的树 $T$
输出：树的Prufer编码 $f(T) = a_1a_2\dots a_{n - 2}$
迭代：第 $i$ 步，在剩下的顶点中删除最小的叶子，令 $a_i =$ 该叶子的相邻顶点


### 定理 9.7 Cayley 公式

$\tau(K_n) = n^{n - 2}$

令 $V(K_n) = \{1,2,\dots, n\}$，用 $V$ 中元素构造长度为 $n - 2$ 的序列，这些序列与 $K_n$ 的生成树是一一对应的。

这种长度为 $n-2$ 的序列称为 Prufer code

### 习题
计算 $\tau(K_n - e)$

> 用对称性
> $\tau(K_n - e) = \tau(K_n) - 2n^{n - 3} = (n - 2)n^{n - 3}$ 
> $\tau(K_n / e) = 2n^{n - 3}$

